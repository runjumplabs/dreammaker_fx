---
layout: default
name: basic_auto_wah
effect_type: envelope-filter-effects
---
<h5>{{ page.title }} </h3>
<ul>
<li>Created by: {{page.creator}} </li>
<li>Minimum firmware ver: {{page.min_firmware}} </li>
<li>Description: {{page.description}} </li>
</ul>
<strong>Arduino sketch</strong>
<pre><code class="cpp" style="arduino">#include "dm_fx.h"

/**
This is an example of an envelope filter or "auto-wah".  It uses the amplitude
of the incoming signal to the center frequency of a bandpass filter in real time.
The louder you play, the higher the filter is swept.


                          +------------+
                          |            |
Instr In +-------+------->+ Bandpass   +-------------------------> Amp Out
                 |        | filter     |
                 |        +-----+------+
                 |              ^
                 |              |  Control center frequency of filter
                 |        +-----+------+
                 |        |            |
                 +------->+ Envelope   |
                          | tracker    |
                          +------------+


*/

fx_envelope_tracker   envy_tracky(10,     // 10 ms attack
                                  100,    // 100 ms release
                                  false); // not triggered

                                  
fx_biquad_filter      wah_filter(300.0,                 // 300 Hz starting frequency
                                 FILTER_WIDTH_NARROW,   // Narrow
                                 BIQUAD_TYPE_BPF);      // Type is bandpass


void setup() {
  
  // put your setup code here, to run once:
  pedal.init();

  // for template, just pass audio from input to output jack
  pedal.route_audio(pedal.instr_in, wah_filter.input);
  pedal.route_audio(wah_filter.output, pedal.amp_out);

  pedal.route_audio(pedal.instr_in, envy_tracky.input);
  pedal.route_control(envy_tracky.envelope, wah_filter.freq, 1000.0, 300.0);  // map range 0->1 to 300->300+1000
  

  // Optional code to print out the routing details to console
  if (true) {
    pedal.print_instance_stack();
    pedal.print_routing_table();
    pedal.print_param_tables();
  }
  // Run this effect
  pedal.run();

}
  
void loop() {

  // Add an event if pot 0 has changed
  if (pedal.pot_0.has_changed()) { 
    envy_tracky.set_attack_speed_ms(pedal.pot_0.value*1000.0);
  } 

  // Add an event if pot 0 has changed
  if (pedal.pot_1.has_changed()) { 
  } 

  // Add an event if pot 2 has changed
  if (pedal.pot_2.has_changed()) { 
  } 

  // Service 
  pedal.service();
}

</code></pre>
